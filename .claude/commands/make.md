---
description: デッドコード検出、フォーマット、リント、型チェック、テスト、ビルドを順番に実行
allowed-tools: Bash(bun:*)
---

# プロジェクトビルドパイプライン

このコマンドは以下の処理を順番に実行します：

1. **デッドコード検出** - 未使用コードの検出
2. **フォーマット** - コードフォーマットを適用
3. **リント** - コード品質チェック
4. **タイプチェック** - TypeScript型チェック
5. **テスト** - ゲームロジックテストの実行
6. **ビルド** - プロダクションビルド

## 実行

```bash
# 1. デッドコード検出
bun run knip

# 2. フォーマット
bun run format

# 3. リント
bun run lint

# 4. タイプチェック
bun run typecheck

# 5. テスト（ゲームロジックのみ）
bun test src/game/

# 6. ビルド
bun run build
```

各ステップでエラーが発生した場合は処理を停止し、エラー内容を報告します。

## 処理順序の理由

1. **knip**: 最初に実行することで、未使用コードがある場合は早期に検出し、後続の処理時間を削減
2. **format**: コードスタイルを統一してから品質チェックを実行
3. **lint**: フォーマット済みのコードに対して品質チェック
4. **typecheck**: 型の整合性を確認
5. **test**: コードが正しく動作することを確認（ゲームロジックに限定）
6. **build**: すべてのチェックをパスしたコードをビルド

## Bun v1.2.17による高速化

- **テスト実行**: 150-250ms (従来比83%高速化)
- **フォーマット・リント**: 20-40ms合計
- **ビルド時間**: 約1秒
- **全体実行時間**: 2-3秒以内で完了

## 注意事項

- React Testing LibraryのテストはBunとの互換性問題があるため、ゲームロジックテストのみ実行
- knip設定はBun環境用に最適化済み（`knip.json`参照）
- すべてのコマンドはBun経由で実行され、高速化の恩恵を受けます